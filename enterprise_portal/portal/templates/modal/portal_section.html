<style>
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 28px;
    }

    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: 0.4s;
        border-radius: 34px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
    }

    input:checked + .slider {
        background-color: #007bff;
    }

    input:checked + .slider:before {
        transform: translateX(22px);
    }

    .custom-control-input:checked ~ .custom-control-label::after {
        transform: translateX(1rem);
    }
</style>

<!-- Section Modal -->
<div id="create-section-modal" class="fixed inset-0 modal-backdrop hidden z-50">
    <div class="flex items-center justify-center min-h-screen px-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full slide-in-right">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900" id="sectionModalTitle">Create New Section</h3>
            </div>

            <form id="create-section-form" class="p-6 space-y-4" style="max-height: 80vh; overflow-y: scroll">
                {% if factory_id %}
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Factory</label>
                        <input type="hidden" name="factory" value="{{ factory_id }}"/>
                        <input type="text" disabled value="{{ factory_data.name }}"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                {% endif %}
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Name (English)</label>
                    <input type="text" name="name" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Name (Vietnamese)</label>
                    <input type="text" name="name_vi"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Name (Traditional
                        Chinese)</label>
                    <input type="text" name="name_zh_hant" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Section Name (Simplified
                        Chinese)</label>
                    <input type="text" name="name_zh_hans" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (English)</label>
                    <textarea name="description" rows="3"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Vietnamese)</label>
                    <textarea name="description_vi" rows="3"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Traditional
                        Chinese)</label>
                    <textarea name="description_zh_hant" rows="3"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Simplified Chinese)</label>
                    <textarea name="description_zh_hans" rows="3"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="mb-3 col-span-1">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Icon</label>
                        <div class="relative w-full">
                            <!-- Hidden input -->
                            <input type="hidden" name="icon" id="section_selected_icon" value="desktop">

                            <!-- Dropdown toggle -->
                            <button class="w-full flex justify-between items-center px-3 py-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                <span class="flex items-center">
                                    <i id="section_dropdown_icon" class="fas fa-desktop me-2"></i>
                                    <span id="section_dropdown_label">Desktop</span>
                                </span>
                                <i class="fas fa-chevron-down text-gray-500"></i>
                            </button>

                            <!-- Dropdown menu -->
                            <div class="dropdown-menu p-2 w-full" aria-labelledby="dropdownMenuButton">
                                <div class="icon-grid">
                                    <div class="icon-option active" data-value="desktop">
                                        <i class="fas fa-desktop"></i>
                                        <span>Desktop</span>
                                    </div>
                                    <div class="icon-option" data-value="server">
                                        <i class="fas fa-server"></i>
                                        <span>Server</span>
                                    </div>
                                    <div class="icon-option" data-value="database">
                                        <i class="fas fa-database"></i>
                                        <span>Database</span>
                                    </div>
                                    <div class="icon-option" data-value="chart-line">
                                        <i class="fas fa-chart-line"></i>
                                        <span>Analytics</span>
                                    </div>
                                    <div class="icon-option" data-value="cog">
                                        <i class="fas fa-cog"></i>
                                        <span>Settings</span>
                                    </div>
                                    <div class="icon-option" data-value="shield-alt">
                                        <i class="fas fa-shield-alt"></i>
                                        <span>Security</span>
                                    </div>
                                    <div class="icon-option" data-value="users">
                                        <i class="fas fa-users"></i>
                                        <span>Users</span>
                                    </div>
                                    <div class="icon-option" data-value="file-alt">
                                        <i class="fas fa-file-alt"></i>
                                        <span>Documents</span>
                                    </div>
                                    <div class="icon-option" data-value="globe">
                                        <i class="fas fa-globe"></i>
                                        <span>Global</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Icon Color</label>
                        <input type="color" name="color" value="#10b981"
                               class="w-full h-10 border border-gray-300 rounded-lg cursor-pointer">
                    </div>
                </div>

                <div class="d-flex align-items-center gap-3">
                    <label class="block text-sm font-medium text-gray-700">Visibility:</label>
                    <div class="d-flex align-items-center">
                        <label class="switch m-0">
                            <input type="checkbox" name="is_active" id="visibilityToggle">
                            <span class="slider round"></span>
                        </label>
                        <span id="visibilityLabel" class="ml-2 font-weight-bold">Public</span>
                    </div>
                </div>
            </form>

            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeModal('create-section-modal')"
                        class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                    Cancel
                </button>
                <button onclick="" id="sectionModalSubmitButton"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    Create Section
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const toggle = document.getElementById('visibilityToggle');
        const label = document.getElementById('visibilityLabel');

        if (toggle && label) {
            label.textContent = toggle.checked ? 'Public' : 'Private';

            toggle.addEventListener('change', function () {
                label.textContent = this.checked ? 'Public' : 'Private';
            });
        }
    });

    document.querySelectorAll(".icon-option").forEach(option => {
        option.addEventListener("click", () => {
            // remove old active
            document.querySelectorAll(".icon-option").forEach(o => o.classList.remove("active"));
            option.classList.add("active");

            // set values
            const value = option.getAttribute("data-value");
            const text = option.querySelector("span").innerText;

            document.getElementById("section_selected_icon").value = value;
            document.getElementById("section_dropdown_label").innerText = text;

            document.getElementById('section_dropdown_icon').className = `fas fa-${value} me-2`;

            // close dropdown
            const dropdown = bootstrap.Dropdown.getInstance(document.getElementById("dropdownMenuButton"));
            dropdown.hide();
        });
    });
</script>