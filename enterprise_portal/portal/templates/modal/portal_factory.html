<!-- Factory Modal -->
<div id="create-factory-modal" class="fixed inset-0 modal-backdrop hidden z-50">
    <div class="flex items-center justify-center min-h-screen px-4">
        <div class="bg-white rounded-xl shadow-xl max-w-lg w-full slide-in-right">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900" id="factoryModalTitle">Create New Factory</h3>
            </div>

            <form id="create-factory-form" class="p-6 space-y-4" style="max-height: 80vh; overflow-y: scroll">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name (English)</label>
                        <input type="text" name="name" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name (Vietnamese)</label>
                        <input type="text" name="name_vi"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name (Traditional Chinese)</label>
                        <input type="text" name="name_zh_hant"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name (Simplified Chinese)</label>
                        <input type="text" name="name_zh_hans"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">URL</label>
                    <input type="url" name="url" required placeholder="https://example.com"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (English)</label>
                    <textarea name="description" rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Vietnamese)</label>
                    <textarea name="description_vi" rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Traditional
                        Chinese)</label>
                    <textarea name="description_zh_hant" rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Simplified Chinese)</label>
                    <textarea name="description_zh_hans" rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div class="mb-3 col-span-1">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Icon</label>
                        <div class="relative w-full">
                            <!-- Hidden input -->
                            <input type="hidden" name="icon" id="factory_selected_icon" value="desktop">

                            <!-- Dropdown toggle -->
                            <button class="w-full flex justify-between items-center px-3 py-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                <span class="flex items-center">
                                    <i id="factory_dropdown_icon" class="fas fa-desktop me-2"></i>
                                    <span id="factory_dropdown_label">Desktop</span>
                                </span>
                                <i class="fas fa-chevron-down text-gray-500"></i>
                            </button>

                            <!-- Dropdown menu -->
                            <div class="dropdown-menu p-2 w-full" aria-labelledby="dropdownMenuButton">
                                <div class="icon-grid">
                                    <div class="icon-option active" data-value="desktop">
                                        <i class="fas fa-desktop"></i>
                                        <span>Desktop</span>
                                    </div>
                                    <div class="icon-option" data-value="server">
                                        <i class="fas fa-server"></i>
                                        <span>Server</span>
                                    </div>
                                    <div class="icon-option" data-value="database">
                                        <i class="fas fa-database"></i>
                                        <span>Database</span>
                                    </div>
                                    <div class="icon-option" data-value="chart-line">
                                        <i class="fas fa-chart-line"></i>
                                        <span>Analytics</span>
                                    </div>
                                    <div class="icon-option" data-value="cog">
                                        <i class="fas fa-cog"></i>
                                        <span>Settings</span>
                                    </div>
                                    <div class="icon-option" data-value="shield-alt">
                                        <i class="fas fa-shield-alt"></i>
                                        <span>Security</span>
                                    </div>
                                    <div class="icon-option" data-value="users">
                                        <i class="fas fa-users"></i>
                                        <span>Users</span>
                                    </div>
                                    <div class="icon-option" data-value="file-alt">
                                        <i class="fas fa-file-alt"></i>
                                        <span>Documents</span>
                                    </div>
                                    <div class="icon-option" data-value="globe">
                                        <i class="fas fa-globe"></i>
                                        <span>Global</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Background</label>
                        <input type="color" name="background_color" value="#6366f1"
                               class="w-full h-10 border border-gray-300 rounded-lg cursor-pointer">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                        <input type="color" name="text_color" value="#ffffff"
                               class="w-full h-10 border border-gray-300 rounded-lg cursor-pointer">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Access Level</label>
                    <select name="access_level"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        <option value="public">Public</option>
                        <option value="authenticated">Authenticated</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
            </form>

            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeModal('create-factory-modal')"
                        class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                    Cancel
                </button>
                <button onclick="" id="factoryModalSubmitButton"
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                    Create Factory
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelectorAll(".icon-option").forEach(option => {
        option.addEventListener("click", () => {
            // remove old active
            document.querySelectorAll(".icon-option").forEach(o => o.classList.remove("active"));
            option.classList.add("active");

            // set values
            const value = option.getAttribute("data-value");
            const text = option.querySelector("span").innerText;

            document.getElementById("factory_selected_icon").value = value;
            document.getElementById("factory_dropdown_label").innerText = text;

            document.getElementById('factory_dropdown_icon').className = `fas fa-${value} me-2`;

            // close dropdown
            const dropdown = bootstrap.Dropdown.getInstance(document.getElementById("dropdownMenuButton"));
            dropdown.hide();
        });
    });
</script>